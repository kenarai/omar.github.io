---
layout: post
title: Changing a query string value in ASP.NET MVC
tags: asp.net-mvc
---
<p>I've come across more than one occasion where a link on a page only needs to modify one or more query string values. Take for example a simple pagination list:</p>

{% highlight csharp %}	
<ul>
   @for (int i = 1; i < Model.PageCount; i++) 
   {
      <li>
         <a href="@Url.Action("Index", "Home", new { page = i })">@i</a>
      </li> 
   }
</ul>
{% endhighlight %}

<p>The <code>action</code> and <code>controller</code> declaration in <code>@Url.Action("Index", "Home", new { page = i })</code> is redundant. A more succinct call would be easier on the eyes (and fingers):</p>

<p><code>@Url.RouteValueChange(new { page = i})</code></p>

<p>This should generate the current URL but with an updated <code>page</code> query string value.</p>

<p>This can be achived with a simple <code>UrlHelper</code> extension method:</p>


{% highlight csharp %}					
public static HtmlString RouteValueChange(this UrlHelper url, object routeValues)
{
    // Convert new route values to a dictionary
    RouteValueDictionary newRoute = new RouteValueDictionary(routeValues);
    
    // Get the route data of the current Url
    var current = url.RequestContext.RouteData.Values;
    
    // Merge the new values INTO the current values, overwriting any existing values/querystrings
    foreach (var item in newRoute)
    	current[item.Key] = item.Value;
    
    // Generate the new Url
    var newUrl = url.RouteUrl(current);
    return new HtmlString(newUrl);
}
{% endhighlight %}

<p><em>Note:</em> Passing an object with an  <code>action</code> or <code>controller</code> value will change the action/controller.</p>

<p>Creating an <code>ActionLink</code> from the URL helper is left as an exercise for the reader.</p>